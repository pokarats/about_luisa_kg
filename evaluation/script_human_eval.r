library(readr)
library(lme4)
library(ggplot2)
library(dplyr)

data <- read_tsv("Preprocessed_Results_Human_Evaluation.txt")
data$Criterion <- as.factor(data$Criterion)
data$Score <- as.integer(data$Score)
data$Participant <- as.factor(data$Participant)
data$Condition <- as.factor(data$Condition)
data$ID <- as.factor(data$ID)

data <- na.omit(data)
data2 <- summarise(group_by(data, Condition, Criterion), mean=mean(Score))
ggplot(data2, aes(x=Criterion, y=mean)) + geom_point(aes(color = Condition))

aggregate(data$Score, list(data$Participant), FUN=mean)
aggregate(data$Score, list(data$Question), FUN=mean)
aggregate(data$Score, list(data$Condition), FUN=mean)
aggregate(data$Score, list(data$Criterion), FUN=mean)

general_model <- lmer(Score ~ Condition + (1 + Condition | Participant) + (1 + Condition | Question), data)
summary(general_model)

G <- subset(data,Criterion %in% c("G"))
G_means <- summarise(group_by(G, Condition, Question), mean_run = mean(Score))
ggplot(G_means, aes(x=Question, y=mean_run)) + geom_line(aes(color = Condition))
G_model <- lmer(Score ~ Condition + (1 + Condition | Participant) + (1 + Condition | Question), G)
summary(G_model)

F <- subset(data,Criterion %in% c("F"))
aggregate(F$Score, list(F$Condition), FUN=mean)
F_means <- summarise(group_by(F, Condition, Question), mean_run = mean(Score))
ggplot(F_means, aes(x=Question, y=mean_run)) + geom_line(aes(color = Condition))
F_model <- lmer(Score ~ Condition + (1 + Condition | Participant) + (1 + Condition | Question), F)
summary(F_model)

C <- subset(data,Criterion %in% c("C"))
C_means <- summarise(group_by(C, Condition, Question), mean_run = mean(Score))
ggplot(C_means, aes(x=Question, y=mean_run)) + geom_line(aes(color = Condition))
aggregate(C$Score, list(C$Condition), FUN=mean)
C_model <- lmer(Score ~ Condition + (1 + Condition | Participant) + (1 + Condition | Question), C)
summary(C_model)

A <- subset(data,Criterion %in% c("A"))
A_means <- summarise(group_by(A, Condition, Question), mean_run = mean(Score))
ggplot(A_means, aes(x=Question, y=mean_run)) + geom_line(aes(color = Condition))
aggregate(A$Score, list(A$Condition), FUN=mean)
A_model <- lmer(Score ~ Condition + (1 + Condition | Participant) + (1 + Condition | Question), A)
summary(A_model)
